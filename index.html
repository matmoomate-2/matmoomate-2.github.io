<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rate this project</title>
  <style>
    .star { font-size: 2rem; cursor: pointer; color: #ccc; }
    .star.active { color: gold; }
  </style>
</head>
<body>

<h2>Rate this project</h2>
<div id="stars">
  <span class="star" data-value="1">★</span>
  <span class="star" data-value="2">★</span>
  <span class="star" data-value="3">★</span>
  <span class="star" data-value="4">★</span>
  <span class="star" data-value="5">★</span>
</div>

<p id="status"></p>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getFirestore, doc, runTransaction } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.querySelectorAll(".star").forEach(star => {
    star.onclick = async () => {
      const value = Number(star.dataset.value);

      const ref = doc(db, "ratings", "main");

      await runTransaction(db, async (tx) => {
        const snap = await tx.get(ref);
        const data = snap.exists()
          ? snap.data()
          : { total: 0, count: 0 };

        tx.set(ref, {
          total: data.total + value,
          count: data.count + 1
        });
      });

      document.getElementById("status").textContent =
        "Thanks for rating!";
    };
  });
</script>

</body>
</html>
